---
title: "Point Generation Tutorial"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Point Generation Tutorial}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 7,
  fig.height = 5
)
```

# Introduction

This package provides tools for generating different types of point patterns within spatial boundaries (rasters or polygons). You can create:

- Regular grid patterns with exact point counts
- Regular grid patterns with specified spacing
- Random point distributions

## Setup

```{r setup}
library(positionR)  # Replace with your actual package name
library(raster)
library(sf)
library(ggplot2)

# Set seed for reproducible results
set.seed(123)
```

## Creating Sample Data

Let's create some sample spatial objects to work with:

```{r create-data}
# Create a simple raster
r <- raster(matrix(runif(100, 0, 50), 10, 10))
extent(r) <- c(0, 1000, 0, 1000)  # Set extent in meters
crs(r) <- "+proj=utm +zone=10 +datum=WGS84"

# Create a polygon
coords <- matrix(c(200, 200,
                   800, 200,
                   800, 800,
                   600, 900,
                   200, 800,
                   200, 200), ncol = 2, byrow = TRUE)
poly <- st_polygon(list(coords))
poly_sf <- st_sfc(poly, crs = "+proj=utm +zone=10 +datum=WGS84")

print(paste("Raster dimensions:", nrow(r), "x", ncol(r)))
print(paste("Polygon area:", round(st_area(poly_sf)), "mÂ²"))
```

## Regular Points with Exact Count

Generate a specific number of regularly spaced points:

```{r regular-exact}
# Generate 25 regular points in the raster
regular_raster <- generate_exact_regular_points(r, n_points = 25, seed = 123)

# Generate 20 regular points in the polygon
regular_poly <- generate_exact_regular_points(poly_sf, n_points = 20, seed = 123)

print(paste("Points generated in raster:", nrow(regular_raster)))
print(paste("Points generated in polygon:", nrow(regular_poly)))
```

### Plot Results

```{r plot-regular, fig.cap="Regular points with exact count"}
# Plot raster with points
p1 <- plot_points_on_input(r, regular_raster)
print(p1)

# Plot polygon with points
p2 <- plot_points_on_input(poly_sf, regular_poly)
print(p2)
```

## Points with Specified Spacing

Generate points with a defined distance between them:

```{r spaced-points}
# Generate points every 150 meters in the raster
spaced_raster <- generate_spaced_points(r, spacing = 150, seed = 123)

# Generate points every 100 meters in the polygon
spaced_poly <- generate_spaced_points(poly_sf, spacing = 100, seed = 123)

print(paste("Spaced points in raster:", nrow(spaced_raster)))
print(paste("Spaced points in polygon:", nrow(spaced_poly)))
```

### Plot Results

```{r plot-spaced, fig.cap="Points with specified spacing"}
# Plot results
p3 <- plot_points_on_input(r, spaced_raster)
print(p3)

p4 <- plot_points_on_input(poly_sf, spaced_poly)
print(p4)
```

## Random Points

Generate randomly distributed points:

```{r random-points}
# Generate 30 random points in the raster
random_raster <- generate_random_points(r, n_points = 30, seed = 456)

# Generate 25 random points in the polygon
random_poly <- generate_random_points(poly_sf, n_points = 25, seed = 456)

print(paste("Random points in raster:", nrow(random_raster)))
print(paste("Random points in polygon:", nrow(random_poly)))
```

### Plot Results

```{r plot-random, fig.cap="Randomly distributed points"}
# Plot results
p5 <- plot_points_on_input(r, random_raster)
print(p5)

p6 <- plot_points_on_input(poly_sf, random_poly)
print(p6)
```

## Examining the Output

Let's look at the structure of the generated points:

```{r examine-output}
# Check the structure
print("Regular points structure:")
str(regular_raster)

print("\nFirst few rows of regular points:")
head(regular_raster)

print("\nMethod information:")
attr(regular_raster, "method_info")

# Check if raster values were extracted
if ("raster_value" %in% names(regular_raster)) {
  print("\nRaster value statistics:")
  summary(regular_raster$raster_value)
}
```

## Comparing Methods

Let's compare the three methods side by side:

```{r comparison-table}
# Create comparison summary
comparison <- data.frame(
  Method = c("Regular (exact)", "Spaced", "Random"),
  Points_Raster = c(nrow(regular_raster), nrow(spaced_raster), nrow(random_raster)),
  Points_Polygon = c(nrow(regular_poly), nrow(spaced_poly), nrow(random_poly)),
  Method_Info = c(
    attr(regular_raster, "method_info"),
    attr(spaced_raster, "method_info"), 
    attr(random_raster, "method_info")
  )
)

print(comparison)
```

## Advanced Usage: Different Input Types

The functions work with various spatial object types:

```{r different-inputs, eval=FALSE}
# Works with different raster types
brick_example <- brick(r, r*2, r*3)
points_brick <- generate_random_points(brick_example, n_points = 15)

# Works with sp objects (if you have them)
# poly_sp <- as(poly_sf, "Spatial")
# points_sp <- generate_spaced_points(poly_sp, spacing = 200)
```

## Tips and Best Practices

1. **Choose appropriate spacing**: For regular grids, consider your study area size and analysis requirements.

2. **Use seeds for reproducibility**: Always set a seed when you need consistent results.

3. **Check point counts**: The actual number of points may vary slightly with the spacing method depending on boundary shapes.

4. **Coordinate systems matter**: Ensure your spatial objects have appropriate coordinate reference systems, especially for spacing calculations.

5. **Memory considerations**: Large rasters or very dense point patterns can be memory-intensive.

## Session Information

```{r session-info}
sessionInfo()
```
